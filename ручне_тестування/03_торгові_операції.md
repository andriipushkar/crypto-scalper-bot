# Тести торгових операцій

## 1. Відкриття позицій

### TC-037: Відкриття LONG позиції (Market)
**Кроки:**
1. Вибрати символ (напр. BTCUSDT)
2. Натиснути кнопку "Long" або "Buy"
3. Ввести кількість (напр. 0.001 BTC)
4. Підтвердити ордер

**Очікуваний результат:**
- [ ] Ордер прийнято
- [ ] Позиція з'явилась в списку позицій
- [ ] Side = LONG/BUY
- [ ] Entry price відповідає ринковій ціні
- [ ] Баланс зменшився на margin
- [ ] Toast notification про успіх

### TC-038: Відкриття SHORT позиції (Market)
**Кроки:**
1. Вибрати символ
2. Натиснути "Short" або "Sell"
3. Ввести кількість
4. Підтвердити

**Очікуваний результат:**
- [ ] Позиція SHORT відкрита
- [ ] Side = SHORT/SELL
- [ ] Entry price коректний

### TC-039: Відкриття позиції з Limit ордером
**Кроки:**
1. Вибрати тип ордера "LIMIT"
2. Ввести ціну (нижче ринкової для BUY, вище для SELL)
3. Ввести кількість
4. Підтвердити

**Очікуваний результат:**
- [ ] Ордер створено в статусі "Pending" або "Open"
- [ ] Ордер відображається в списку ордерів
- [ ] Позиція НЕ відкрита (поки ордер не виконається)

### TC-040: Відкриття позиції з недостатнім балансом
**Кроки:**
1. Спробувати відкрити позицію більшу за доступний баланс

**Очікуваний результат:**
- [ ] Помилка "Insufficient balance"
- [ ] Ордер не створено
- [ ] Позиція не відкрита

### TC-041: Відкриття позиції з невалідним символом
**Кроки:**
1. Спробувати відкрити позицію для неіснуючого символу

**Очікуваний результат:**
- [ ] Помилка "Invalid symbol"
- [ ] Ордер не створено

### TC-042: Відкриття позиції з нульовою кількістю
**Кроки:**
1. Ввести quantity = 0
2. Спробувати підтвердити

**Очікуваний результат:**
- [ ] Валідація: "Quantity must be > 0"
- [ ] Кнопка неактивна або помилка

---

## 2. Закриття позицій

### TC-043: Повне закриття позиції
**Кроки:**
1. Мати відкриту позицію
2. Натиснути "Close" без вказання кількості
3. Підтвердити

**Очікуваний результат:**
- [ ] Позиція закрита повністю
- [ ] Позиція зникла зі списку
- [ ] P&L розраховано
- [ ] Угода додана в історію
- [ ] Баланс оновлено

### TC-044: Часткове закриття позиції
**Кроки:**
1. Мати позицію 0.01 BTC
2. Закрити 0.005 BTC

**Очікуваний результат:**
- [ ] Позиція зменшилась до 0.005 BTC
- [ ] Частковий P&L зараховано
- [ ] Позиція залишається в списку

### TC-045: Закриття з прибутком (TP hit)
**Кроки:**
1. Відкрити LONG позицію
2. Ціна зросла вище entry
3. Закрити позицію

**Очікуваний результат:**
- [ ] P&L позитивний (зелений)
- [ ] Баланс збільшився
- [ ] Win rate оновлено

### TC-046: Закриття зі збитком (SL hit)
**Кроки:**
1. Відкрити LONG позицію
2. Ціна впала нижче entry
3. Закрити позицію

**Очікуваний результат:**
- [ ] P&L негативний (червоний)
- [ ] Баланс зменшився
- [ ] Loss зафіксовано

---

## 3. Stop-Loss та Take-Profit

### TC-047: Встановлення Stop-Loss
**Кроки:**
1. Відкрити позицію
2. Встановити SL (напр. -2% від entry)
3. Зберегти

**Очікуваний результат:**
- [ ] SL відображається в позиції
- [ ] SL валідований (нижче entry для LONG)
- [ ] При досягненні ціни - автоматичне закриття

### TC-048: Встановлення Take-Profit
**Кроки:**
1. Відкрити позицію
2. Встановити TP (напр. +3% від entry)
3. Зберегти

**Очікуваний результат:**
- [ ] TP відображається в позиції
- [ ] TP валідований (вище entry для LONG)
- [ ] При досягненні ціни - автоматичне закриття

### TC-049: SL/TP для SHORT позиції
**Кроки:**
1. Відкрити SHORT позицію
2. Встановити SL (вище entry) та TP (нижче entry)

**Очікуваний результат:**
- [ ] SL вище entry price
- [ ] TP нижче entry price
- [ ] Валідація працює правильно

### TC-050: Зміна SL/TP на існуючій позиції
**Кроки:**
1. Мати позицію з SL/TP
2. Змінити значення
3. Зберегти

**Очікуваний результат:**
- [ ] Нові значення збережено
- [ ] Старі ордери скасовано
- [ ] Нові ордери створено

### TC-051: Trailing Stop-Loss
**Кроки:**
1. Відкрити позицію
2. Увімкнути Trailing SL з offset (напр. 1%)
3. Ціна рухається в прибуток

**Очікуваний результат:**
- [ ] SL рухається за ціною
- [ ] SL підтягується при прибутку
- [ ] SL не рухається при збитку
- [ ] Спрацьовує при розвороті

---

## 4. Leverage

### TC-052: Встановлення leverage
**Кроки:**
1. Вибрати символ
2. Встановити leverage (напр. 10x)
3. Відкрити позицію

**Очікуваний результат:**
- [ ] Leverage відображається в позиції
- [ ] Margin = Position Size / Leverage
- [ ] P&L мультиплікується

### TC-053: Зміна leverage (валідні значення)
**Кроки:**
1. Спробувати різні значення: 1x, 5x, 10x, 20x, 50x, 100x, 125x

**Очікуваний результат:**
- [ ] Всі валідні значення приймаються
- [ ] UI оновлюється

### TC-054: Невалідний leverage
**Кроки:**
1. Спробувати leverage = 0, -1, 200, "abc"

**Очікуваний результат:**
- [ ] Помилка валідації
- [ ] Значення не застосовано

### TC-055: Leverage при відкритій позиції
**Кроки:**
1. Мати відкриту позицію
2. Спробувати змінити leverage

**Очікуваний результат:**
- [ ] Попередження або заборона (залежить від біржі)
- [ ] Потрібно закрити позицію спочатку

---

## 5. DCA (Dollar Cost Averaging)

### TC-056: Safety Order спрацювання
**Кроки:**
1. Увімкнути DCA стратегію
2. Відкрити позицію
3. Ціна пішла проти позиції на N%

**Очікуваний результат:**
- [ ] Safety order виконано
- [ ] Розмір позиції збільшився
- [ ] Entry price усереднився
- [ ] Лог про виконання SO

### TC-057: Максимальна кількість Safety Orders
**Кроки:**
1. Налаштувати max_safety_orders = 3
2. Ціна продовжує падати

**Очікуваний результат:**
- [ ] Виконано максимум 3 SO
- [ ] Далі SO не створюються
- [ ] Позиція залишається без змін

### TC-058: DCA Step Scale
**Кроки:**
1. Налаштувати step_scale = 1.5
2. Safety orders 1%, потім 1.5%, потім 2.25%

**Очікуваний результат:**
- [ ] Кожен наступний SO на більшій відстані
- [ ] Розрахунок відповідає формулі

---

## 6. Ордери

### TC-059: Скасування pending ордера
**Кроки:**
1. Створити limit ордер
2. Натиснути "Cancel"

**Очікуваний результат:**
- [ ] Ордер скасовано
- [ ] Зникає зі списку ордерів
- [ ] Margin повернуто

### TC-060: Перегляд історії ордерів
**Кроки:**
1. Перейти на вкладку "Orders" або "History"

**Очікуваний результат:**
- [ ] Список всіх ордерів
- [ ] Статуси: Filled, Cancelled, Pending
- [ ] Фільтрація працює

### TC-061: Модифікація ордера
**Кроки:**
1. Мати pending limit ордер
2. Змінити ціну

**Очікуваний результат:**
- [ ] Ордер оновлено
- [ ] Нова ціна відображається

---

## 7. Калькулятор позицій

### TC-062: Розрахунок розміру позиції
**Кроки:**
1. Відкрити калькулятор
2. Ввести: Balance $1000, Risk 2%, SL 1%

**Очікуваний результат:**
- [ ] Position size = $2000 (з leverage)
- [ ] Потенційний збиток = $20
- [ ] Формула правильна

### TC-063: Розрахунок P&L
**Кроки:**
1. Ввести Entry, Exit, Size, Leverage

**Очікуваний результат:**
- [ ] P&L в USD
- [ ] P&L в %
- [ ] ROE (Return on Equity)
- [ ] Враховано комісії

### TC-064: Розрахунок ліквідаційної ціни
**Кроки:**
1. Ввести Entry, Size, Leverage, Margin

**Очікуваний результат:**
- [ ] Liquidation price розраховано
- [ ] Відповідає формулі біржі
